<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Sizin uygulamanƒ±zƒ±n ba≈ülƒ±ƒüƒ± -->
    <title>Be≈üel LearnLabüî¨</title>
    
    <!-- Sizin uygulamanƒ±z i√ßin gereken Fontlar, Ikonlar ve K√ºt√ºphaneler -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>

    <style>
        /* === Lƒ∞SANS Gƒ∞Rƒ∞≈û EKRANI STƒ∞LLERƒ∞ === */
        body, html {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #0c0a09; /* Sizin uygulamanƒ±zƒ±n arka plan rengi */
            color: #f5f5f4;
            height: 100%;
            width: 100%;
            overflow: hidden; /* Kaydƒ±rmayƒ± engelle */
        }
        #license-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000; /* En √ºstte olmalƒ± */
        }
        #license-modal {
            background: #1c1917; /* Y√ºzey rengi */
            padding: 30px;
            border-radius: 16px; /* radius-lg */
            border: 1px solid rgba(255, 255, 255, 0.1); /* surface-border */
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            text-align: center;
            width: 90%;
            max-width: 400px;
        }
        #license-modal h2 {
            margin-top: 0;
            color: #f5f5f4; /* text-primary */
        }
        #license-modal p {
            color: #a8a29e; /* text-secondary */
        }
        #license-key {
            width: calc(100% - 22px);
            padding: 12px;
            margin-top: 10px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background-color: #0c0a09;
            color: #f5f5f4;
            border-radius: 10px; /* radius-md */
            font-size: 16px;
        }
        #license-key::placeholder {
            color: #57534e; /* text-placeholder */
        }
        #license-form button {
            width: 100%;
            padding: 12px;
            background-color: #00B9E4; /* brand-color */
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        #license-form button:hover {
            background-color: #0098c2; /* brand-color-dark */
        }
        #error-message {
            color: #F43F5E; /* danger-color */
            margin-top: 15px;
            display: none; /* Ba≈ülangƒ±√ßta gizli */
            font-weight: 500;
        }

        /* === Sƒ∞Zƒ∞N UYGULAMANIZIN STƒ∞LLERƒ∞ === */
        /* Sizin <style> etiketinizdeki t√ºm i√ßerik buraya kopyalandƒ± */
        :root {
            --brand-color: #00B9E4;
            --brand-color-light: #77dff9;
            --brand-color-dark: #0098c2;
            --success-color: #22C55E;
            --danger-color: #F43F5E;
            --warning-color: #F59E0B;
            --info-color: #3B82F6;
            --bg-color: #0c0a09;
            --surface-color: #1c1917;
            --surface-glass: rgba(28, 25, 23, 0.5);
            --surface-border: rgba(255, 255, 255, 0.1);
            --text-primary: #f5f5f4;
            --text-secondary: #a8a29e;
            --text-placeholder: #57534e;
            --shadow-color: rgba(0, 0, 0, 0.5);
            --glow-color: rgba(0, 185, 228, 0.2);
            --radius-md: 10px;
            --radius-lg: 16px;
            --transition-speed: 0.3s;
            --transition-curve: cubic-bezier(0.25, 0.46, 0.45, 0.94);
            /* Flashcard styles that can be customized */
            --flashcard-width: 450px;
            --flashcard-height: 280px;
            --flashcard-question-size: 32px;
            --flashcard-answer-size: 24px;
            --flashcard-bg-color: var(--surface-glass);
            --flashcard-question-color: var(--text-primary);
            --flashcard-answer-color: var(--text-primary);
        }

        * { box-sizing: border-box; }
        /* body, html stilleri yukarƒ±da lisans ekranƒ± i√ßin birle≈ütirildi */
        
        /* Sizin stillerinizin geri kalanƒ± */
        .app-container { width: 100%; height: 100vh; display: flex; transition: padding var(--transition-speed) var(--transition-curve); }
        .app-container.theater-mode { padding: 1rem 2rem; }
        .video-content { flex-grow: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; transition: all var(--transition-speed) var(--transition-curve); height: 100%; }
        
        /* === CSS G√úNCELLEMESƒ∞ BA≈ûLANGICI: Oynatƒ±cƒ±nƒ±n ekrana daha iyi sƒ±ƒümasƒ± i√ßin === */
        .player-wrapper {
            position: relative; 
            width: 90vw; 
            height: 90vh; /* Eklendi: y√ºksekliƒüi viewport'a g√∂re ayarla */
            max-width: 1200px; 
            max-height: 720px; /* Eklendi: 16:9 i√ßin maksimum y√ºkseklik sƒ±nƒ±rƒ± */
            border-radius: var(--radius-lg);
            background-color: var(--surface-color); 
            border: 1px solid var(--surface-border);
            box-shadow: 0 25px 50px -12px var(--shadow-color); 
            overflow: hidden;
            transition: all var(--transition-speed) var(--transition-curve); 
            z-index: 10;
            display: flex; /* Eklendi: i√ßindeki video-container'ƒ±n y√ºksekliƒüini almasƒ± i√ßin */
            flex-direction: column; /* Eklendi */
        }
        .app-container.theater-mode .player-wrapper { 
            width: 100%; 
            max-width: none; 
            height: 100%; 
            max-height: none; /* Tiyatro modunda sƒ±nƒ±rƒ± kaldƒ±r */
            border-radius: var(--radius-md); 
        }
        .video-container {
            position: relative; 
            width: 100%; 
            background-color: #000; 
            /* aspect-ratio: 16 / 9; */ /* Kaldƒ±rƒ±ldƒ±: Sabit oran yerine y√ºksekliƒüi doldur */
            height: 100%; /* Eklendi: wrapper'ƒ±n y√ºksekliƒüini doldur */
            display: flex; 
            justify-content: center; 
            align-items: center;
        }
        /* === CSS G√úNCELLEMESƒ∞ SONU === */
        
        .app-container.theater-mode .video-container { 
            height: 100%; 
            aspect-ratio: unset; /* Tiyatro modunda aspect-ratio olmamalƒ±, bu doƒüru */
        }

        /* ===== TAM EKRAN D√úZELTMESƒ∞ BA≈ûLANGICI ===== */
        /* JavaScript'in eklediƒüi .fullscreen sƒ±nƒ±fƒ±nƒ± kullanarak tam ekran stilini uygula */
        .app-container.fullscreen .player-wrapper {
            width: 100%;
            height: 100%;
            max-width: none;
            max-height: none;
            border-radius: 0;
            border: none;
        }
        /* ===== TAM EKRAN D√úZELTMESƒ∞ SONU ===== */

        .video-container.cursor-hidden { cursor: none; }
        video, #youtube-player { width: 100%; height: 100%; display: block; object-fit: contain; position: absolute; top: 0; left: 0; }
        video { z-index: 1; }
        #youtube-player { z-index: 2; }

        /* UPLOAD ZONE (inside settings) */
        #upload-zone {
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            gap: 1rem;
        }
        #upload-zone h3 {
            margin-top: 1rem; margin-bottom: 0.5rem; width: 100%;
            text-align: center; font-weight: 600; font-size: 1.1rem;
            color: var(--text-primary); border-bottom: 1px solid var(--surface-border); padding-bottom: 0.75rem;
        }
        #upload-zone-content {
            text-align: center; cursor: pointer; width: 100%; padding: 2rem; border-radius: var(--radius-md);
            border: 2px dashed var(--text-placeholder);
            transition: background-color var(--transition-speed), border-color var(--transition-speed);
        }
        #upload-zone-content:hover { background-color: rgba(255,255,255,0.05); }
        #upload-zone-content.dragover { background-color: var(--glow-color); border-color: var(--brand-color); }
        #upload-zone-content i { font-size: 3rem; color: var(--brand-color); margin-bottom: 1rem; }
        #upload-zone-content p { font-size: 1.1rem; color: var(--text-secondary); font-weight: 500; }
        .separator { color: var(--text-secondary); margin: 1.5rem 0; font-weight: 500; }
        #youtube-url-container { display: flex; width: 100%; max-width: 500px; gap: 0.5rem; }
        #youtube-url { flex-grow: 1; padding: 0.75rem 1rem; background-color: var(--surface-color); border: 1px solid var(--surface-border); border-radius: var(--radius-md); color: var(--text-primary); font-size: 1rem; }
        #load-youtube-btn { padding: 0 1.5rem; background-color: var(--brand-color); border: none; color: white; border-radius: var(--radius-md); cursor: pointer; font-weight: 600; font-size: 1rem; transition: background-color var(--transition-speed); }
        #load-youtube-btn:hover { background-color: var(--brand-color-dark); }
        #video-upload { display: none; }

        /* CONTROLS */
        .controls-container { position: absolute; bottom: 0; left: 0; right: 0; padding: 0.5rem 1rem; background: linear-gradient(to top, rgba(0, 0, 0, 0.7), transparent); opacity: 0; visibility: hidden; transition: opacity var(--transition-speed) ease-in-out, visibility var(--transition-speed) ease-in-out; z-index: 10; }
        .video-container.controls-visible .controls-container { opacity: 1; visibility: visible; }
        .progress-container { width: 100%; height: 20px; cursor: pointer; }
        .progress-bar { position: relative; width: 100%; height: 4px; background-color: rgba(255, 255, 255, 0.2); border-radius: 4px; transition: height 0.2s ease; }
        .progress-container:hover .progress-bar { height: 6px; }
        .progress-buffered, .progress-played { position: absolute; top: 0; left: 0; height: 100%; border-radius: 4px; }
        .progress-buffered { background-color: rgba(255, 255, 255, 0.35); }
        .progress-played { background-color: var(--brand-color); }
        .progress-thumb { position: absolute; top: 50%; right: 0; transform: translateY(-50%) scale(0); height: 14px; width: 14px; background-color: var(--text-primary); border-radius: 50%; transition: transform 0.2s ease; }
        .progress-container:hover .progress-thumb { transform: translateY(-50%) scale(1); }
        .bottom-controls { display: flex; align-items: center; justify-content: space-between; gap: 1rem; }
        .controls-left, .controls-right { display: flex; align-items: center; gap: 0.5rem; }
        .btn { background: transparent; border: none; color: var(--text-primary); cursor: pointer; font-size: 1.1rem; width: 40px; height: 40px; display: flex; justify-content: center; align-items: center; border-radius: 50%; transition: background-color 0.2s ease, color 0.2s ease; position: relative; }
        .btn:hover { background-color: rgba(255,255,255,0.1); }
        .btn.active { color: var(--brand-color); }
        .btn::after { content: attr(data-tooltip); position: absolute; bottom: 120%; left: 50%; transform: translateX(-50%); background-color: rgba(0,0,0,0.8); color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; white-space: nowrap; opacity: 0; visibility: hidden; transition: opacity 0.2s, visibility 0.2s; pointer-events: none; }
        .btn:hover::after { opacity: 1; visibility: visible; }
        .timestamp { font-size: 0.9rem; color: var(--text-secondary); user-select: none; font-weight: 500; }
        .volume-container { display: flex; align-items: center; }
        .volume-slider-container { width: 0; opacity: 0; visibility: hidden; transition: width 0.3s ease, opacity 0.2s ease; overflow: hidden; }
        .volume-container:hover .volume-slider-container { width: 80px; opacity: 1; visibility: visible; margin-left: 8px; }
        #volume { -webkit-appearance: none; appearance: none; width: 100%; height: 4px; background: rgba(255, 255, 255, 0.3); border-radius: 2px; outline: none; cursor: pointer; }
        #volume::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 14px; height: 14px; background: var(--text-primary); border-radius: 50%; cursor: pointer; }
        #volume::-moz-range-thumb { width: 14px; height: 14px; background: var(--text-primary); border-radius: 50%; cursor: pointer; border: 0; }
        .popup-menu-container { position: relative; }
        .popup-menu { position: absolute; bottom: 120%; right: 50%; transform: translateX(50%); background-color: var(--surface-glass); backdrop-filter: blur(10px); border-radius: var(--radius-md); box-shadow: 0 4px 15px var(--shadow-color); border: 1px solid var(--surface-border); max-height: 200px; overflow-y: auto; opacity: 0; visibility: hidden; transition: opacity 0.2s, visibility 0.2s, transform 0.2s; transform: translateX(50%) translateY(10px); z-index: 15; padding: 0.5rem; }
        .popup-menu.show { opacity: 1; visibility: visible; transform: translateX(50%) translateY(0); }
        .popup-menu ul { list-style: none; }
        .popup-menu li button { background: none; border: none; color: var(--text-primary); cursor: pointer; padding: 0.5rem 1rem; width: 100%; text-align: left; font-size: 0.9rem; border-radius: 6px; transition: background-color 0.15s; }
        .popup-menu li button:hover { background-color: rgba(255,255,255,0.1); }
        .popup-menu li button.active { color: var(--brand-color); font-weight: 600; }

        /* FLASHCARD & QUIZ */
        #flashcard-display {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.95);
            color: var(--text-primary); border-radius: var(--radius-lg); z-index: 20;
            opacity: 0; visibility: hidden; transition: all 0.4s var(--transition-curve);
            text-align: center; width: var(--flashcard-width); height: var(--flashcard-height);
            background-color: var(--flashcard-bg-color); perspective: 1000px;
            border: 1px solid var(--surface-border); box-shadow: 0 8px 32px var(--shadow-color);
            backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            cursor: pointer;
        }
        #flashcard-display.show { opacity: 1; visibility: visible; transform: translate(-50%, -50%) scale(1); }
        .flashcard-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s var(--transition-curve); transform-style: preserve-3d; }
        .flashcard-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 1.5rem; border-radius: var(--radius-lg); overflow: hidden; /* √ñnemli */ }
        .flashcard-face.front { transform: rotateY(0deg); }
        .flashcard-face.back { transform: rotateY(180deg); }
        #flashcard-display.reveal .flashcard-inner { transform: rotateY(180deg); }
        
        .flashcard-color-glow {
            position: absolute;
            top: -20%; left: -20%;
            width: 140%; height: 140%;
            z-index: 0;
            transition: background-color 0.4s;
            opacity: 0.25;
            filter: blur(60px);
            border-radius: 50%;
        }
        
        .flashcard-lang-text {
            position: absolute;
            bottom: 15px;
            right: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
            background-color: rgba(0,0,0,0.3);
            padding: 4px 10px;
            border-radius: var(--radius-md);
            z-index: 2;
            text-transform: capitalize;
            backdrop-filter: blur(4px);
        }

        #flashcard-front-gif img, #flashcard-front-gif p {
            position: relative;
            z-index: 1;
        }


        /* VOICE QUIZ STYLES */
        #voice-quiz-container { display: flex; flex-direction: column; justify-content: center; align-items: center; width: 100%; height: 100%; gap: 1rem; cursor: default; }
        .voice-status { font-size: 1rem; color: var(--text-secondary); font-weight: 500; }
        #mic-animation { position: relative; width: 80px; height: 80px; display: flex; justify-content: center; align-items: center; }
        #mic-animation .fa-microphone { font-size: 2.5rem; color: var(--text-primary); z-index: 2; transition: color 0.3s; }
        #mic-animation .pulse { position: absolute; width: 100%; height: 100%; border-radius: 50%; background-color: var(--brand-color); z-index: 1; transform: scale(0); opacity: 0; }
        #mic-animation.recording .pulse { animation: pulse-wave 2s infinite ease-out; }
        #mic-animation.analyzing .fa-microphone { color: var(--warning-color); }
        #voice-answer-feedback { font-size: 1.2rem; font-weight: 600; min-height: 2rem; }
        #voice-answer-feedback.correct { color: var(--success-color); }
        #check-voice-btn, #pass-voice-btn {
            padding: 0.75rem 1.5rem; border: none;
            color: white; border-radius: var(--radius-md); cursor: pointer;
            font-weight: 600; font-size: 1rem; transition: all 0.2s;
        }
        #check-voice-btn { background-color: var(--brand-color); }
        #check-voice-btn:hover { background-color: var(--brand-color-dark); transform: translateY(-2px); }
        @keyframes pulse-wave {
            0% { transform: scale(0.5); opacity: 0.5; }
            50% { opacity: 0.2; }
            100% { transform: scale(1.2); opacity: 0; }
        }

        /* --- SETTINGS SIDE PANEL STYLES --- */
        .settings-modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(12, 10, 9, 0.6);
            backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
            z-index: 1000;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity var(--transition-speed) var(--transition-curve), visibility var(--transition-speed);
        }
        .settings-modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        .settings-window {
            width: 90vw; max-width: 420px; height: 100vh; max-height: none;
            background-color: var(--surface-glass);
            border: 1px solid var(--surface-border);
            border-left: none;
            border-radius: 0 var(--radius-lg) var(--radius-lg) 0;
            display: flex; flex-direction: column;
            box-shadow: 0 10px 40px var(--shadow-color);
            transform: translateX(-100%);
            opacity: 1;
            transition: transform var(--transition-speed) var(--transition-curve);
        }
        .settings-modal-overlay.show .settings-window {
            transform: translateX(0);
        }
        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 1rem 0.75rem 1.5rem;
            border-bottom: 1px solid var(--surface-border);
            flex-shrink: 0;
        }
        .title-and-credit {
            display: flex;
            align-items: baseline;
            gap: 0.75rem;
        }
        .creator-credit {
            font-size: 0.7rem;
            font-weight: 400;
            color: var(--text-secondary);
            white-space: nowrap;
        }
        .settings-header h2 {
            font-size: 1.1rem;
            font-weight: 600;
        }
        #close-settings-btn {
            font-size: 1.2rem;
            width: 36px;
            height: 36px;
        }
        
        #scoreboard { 
            display: flex; 
            justify-content: space-between; /* space-around'dan deƒüi≈ütirildi */
            align-items: center; 
            padding: 1rem 1.25rem; 
            background-color: rgba(0,0,0,0.2); 
            border-bottom: 1px solid var(--surface-border); 
            flex-shrink: 0; 
        }
        .score-item { text-align: center; }
        .score-label { font-size: 0.9rem; color: var(--text-secondary); display: block; margin-bottom: 4px; }
        .score-value { font-size: 1.5rem; font-weight: 700; }
        .score-value.correct { color: var(--success-color); }
        .score-value.incorrect { color: var(--danger-color); }
        #reset-score-btn { font-size: 1rem; padding: 6px; background-color: transparent; }
        /* Yeni buton i√ßin stili reset-score-btn ile aynƒ± yapƒ±yoruz */
        #close-settings-scoreboard-btn { font-size: 1rem; padding: 6px; background-color: transparent; } 

        .settings-tabs { display: flex; background-color: rgba(0,0,0,0.1); border-bottom: 1px solid var(--surface-border); flex-shrink: 0; }
        .tab-button { flex-grow: 1; padding: 1rem 0.5rem; border: none; background-color: transparent; color: var(--text-secondary); font-size: 0.9rem; cursor: pointer; transition: all 0.2s; border-bottom: 3px solid transparent; font-weight: 600; }
        .tab-button:hover { color: var(--text-primary); background-color: rgba(255, 255, 255, 0.03); }
        .tab-button.active { color: var(--brand-color); border-bottom-color: var(--brand-color); }
        .settings-content-wrapper { padding: 1.5rem; flex-grow: 1; overflow-y: auto; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .settings-window h3 { margin-bottom: 1.5rem; text-align: left; font-weight: 600; font-size: 1.2rem; color: var(--text-primary); border-bottom: 1px solid var(--surface-border); padding-bottom: 0.75rem; }
        .settings-window .setting { margin-bottom: 1.25rem; }
        .settings-window .setting label { display: block; margin-bottom: 0.5rem; font-size: 0.9rem; color: var(--text-secondary); font-weight: 500; }
        .settings-window .setting input[type="text"], .settings-window .setting textarea, .settings-window .setting input[type="number"], .settings-window .setting select, .settings-window .setting input[type="range"] { width: 100%; padding: 0.6rem 0.8rem; background-color: var(--surface-color); border: 1px solid var(--surface-border); border-radius: var(--radius-md); color: var(--text-primary); font-family: inherit; font-size: 0.9rem; transition: all 0.2s; }
        .settings-window .setting input[type="range"] { padding: 0; }
        .settings-window .setting input:focus, .settings-window .setting textarea:focus, .settings-window .setting select:focus { outline: none; border-color: var(--brand-color); box-shadow: 0 0 0 3px var(--glow-color); }
        .settings-window .setting button { width: 100%; padding: 0.75rem; background-color: var(--brand-color); border: none; color: white; border-radius: var(--radius-md); cursor: pointer; margin-top: 1rem; font-weight: 600; font-size: 1rem; transition: all 0.2s; }
        .settings-window .setting button:hover { background-color: var(--brand-color-dark); transform: translateY(-2px); }
        .settings-window .setting .danger-btn { background-color: var(--danger-color); }
        .settings-window .setting .danger-btn:hover { background-color: #c2324c; }
        .settings-window .setting .info-btn { background-color: var(--info-color); }
        .settings-window .setting .info-btn:hover { background-color: #2563EB; }
        .settings-window .setting textarea { resize: vertical; min-height: 80px; }
        .slider-label { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .slider-label span { font-size: 0.8rem; color: var(--text-primary); background-color: var(--surface-color); padding: 2px 6px; border-radius: var(--radius-md); }
        .color-input-container { display: flex; align-items: center; gap: 10px; }
        .color-input-container input[type="color"] { -webkit-appearance: none; -moz-appearance: none; appearance: none; width: 28px; height: 28px; padding: 0; border: none; border-radius: 50%; cursor: pointer; background-color: transparent; }
        .color-input-container input[type="color"]::-webkit-color-swatch { border-radius: 50%; border: 1px solid var(--surface-border); }
        
        .gif-filenames-list {
            list-style: none;
            padding-left: 1rem;
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
            max-height: 100px;
            overflow-y: auto;
        }
        .hidden { display: none !important; }

        .language-color-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--surface-border);
        }
        .language-color-row:last-child {
            border-bottom: none;
        }
        .language-color-row .lang-name {
            font-size: 0.95rem;
            font-weight: 500;
            color: var(--text-primary);
            text-transform: capitalize;
        }
        .language-color-row input[type="color"] {
            width: 32px;
            height: 32px;
        }

        /* MODALS & NOTIFICATIONS */
        .notification-container { position: fixed; bottom: 20px; left: 20px; z-index: 2000; }
        .toast { background-color: var(--surface-glass); backdrop-filter: blur(10px); color: var(--text-primary); padding: 1rem 1.5rem; border-radius: var(--radius-md); box-shadow: 0 5px 15px var(--shadow-color); margin-bottom: 0.5rem; transform: translateX(-120%); animation: slideInToast 0.4s forwards var(--transition-curve), slideOutToast 0.4s 3.5s forwards var(--transition-curve); border-left: 4px solid var(--brand-color); font-size: 0.9rem; font-weight: 500; }
        .toast.error { border-left-color: var(--danger-color); }
        .toast.success { border-left-color: var(--success-color); }
        @keyframes slideInToast { to { transform: translateX(0); } }
        @keyframes slideOutToast { to { transform: translateX(-120%); } }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); backdrop-filter: blur(5px); z-index: 2000; display: flex; justify-content: center; align-items: center; opacity: 0; visibility: hidden; transition: all var(--transition-speed); }
        .modal-overlay.show { opacity: 1; visibility: visible; }
        .modal-content { background: var(--surface-glass); backdrop-filter: blur(15px); padding: 2rem; border-radius: var(--radius-lg); text-align: center; transform: scale(0.9); transition: transform var(--transition-speed) var(--transition-curve); box-shadow: 0 8px 25px var(--shadow-color); border: 1px solid var(--surface-border); max-width: 450px; width: 90%; }
        .modal-overlay.show .modal-content { transform: scale(1); }
        .modal-content p { margin-bottom: 1.5rem; font-size: 1.1rem; color: var(--text-primary); font-weight: 400;}
        .modal-buttons { display: flex; justify-content: center; gap: 1rem; }
        .modal-buttons button { padding: 0.6rem 1.5rem; border: none; border-radius: var(--radius-md); cursor: pointer; font-size: 1rem; font-weight: 600; transition: all 0.2s; }
        #modal-confirm-btn { background-color: var(--danger-color); color: white; }
        #modal-confirm-btn:hover { background-color: #c2324c; }
        #modal-cancel-btn { background-color: #57534e; color: white; }
        #modal-cancel-btn:hover { background-color: #44403c; }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: var(--text-placeholder); border-radius: 8px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--text-secondary); }

        /***********************************/
        /* MOBƒ∞L UYUMLULUK KODLARI         */
        /***********************************/
        @media (max-width: 768px) {
            body {
                height: 100vh;
                overflow: hidden;
            }
            .app-container {
                height: 100vh;
                padding: 0;
            }
            .app-container.theater-mode { padding: 0; }
            .player-wrapper {
                width: 100%; max-width: none; border-radius: 0; border: none;
                height: 100%; 
                max-height: none; /* Mobilde max-height'i kaldƒ±r */
                display: flex; flex-direction: column;
            }
            .video-content { padding: 0; }
            .video-container {
                height: 100%; width: 100%; aspect-ratio: unset; flex-grow: 1;
            }
            #flashcard-display {
                width: 90vw; max-width: 400px; height: auto;
                min-height: 250px; max-height: 60vh;
            }
            .flashcard-face { padding: 1rem; }
            .controls-container { padding: 0.5rem; }
            .bottom-controls { flex-wrap: wrap; justify-content: center; gap: 0.5rem; padding: 0.5rem 0; }
            .controls-left, .controls-right {
                gap: 0.25rem; flex-basis: 100%; justify-content: space-around; padding: 0 0.5rem;
            }
            @media (max-width: 380px) {
                .timestamp { display: none; }
                .btn { width: 36px; height: 36px; font-size: 1rem; }
            }
            .volume-container:hover .volume-slider-container { width: 60px; }
            .settings-window { width: 100vw; border-radius: 0; }
            .settings-content-wrapper { padding: 1rem; }
            .tab-button { padding: 0.8rem 0.25rem; font-size: 0.8rem; }
            .modal-content { width: 90%; }
        }

        /* Asƒ±l i√ßeriƒüi gizle */
        #protected-content {
            display: none;
            /* Sizin uygulamanƒ±zƒ±n 100% y√ºkseklik almasƒ±nƒ± saƒüla */
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>

    <!-- 1. Lƒ∞SANS Gƒ∞Rƒ∞≈û EKRANI -->
    <div id="license-overlay">
        <div id="license-modal">
            <h2>Eri≈üim Gerekli</h2>
            <p>Devam etmek i√ßin lisans kodunuzu girin.</p>
            <form id="license-form">
                <input type="text" id="license-key" placeholder="LISANS-KODUNUZ" required>
                <button type="submit">Giri≈ü Yap</button>
            </form>
            <p id="error-message"></p>
        </div>
    </div>

    <!-- 2. KORUMALI ASIL ƒ∞√áERƒ∞ƒûƒ∞Nƒ∞Z (Sƒ∞Zƒ∞N UYGULAMANIZ) -->
    <!-- Bu div'in i√ßi, lisans doƒürulandƒ±ƒüƒ±nda g√∂sterilecek -->
    <div id="protected-content">
        
        <!-- Sƒ∞Zƒ∞N G√ñNDERDƒ∞ƒûƒ∞Nƒ∞Z DOSYANIN T√úM <body> ƒ∞√áERƒ∞ƒûƒ∞ BURAYA TA≈ûINDI -->

        <div id="notification-container" class="notification-container"></div>
        <div id="modal-overlay" class="modal-overlay">
            <div class="modal-content">
                <p id="modal-text">Emin misiniz?</p>
                <div class="modal-buttons">
                    <button id="modal-cancel-btn">ƒ∞ptal</button> <button id="modal-confirm-btn">Onayla</button>
                </div>
            </div>
        </div>
        
        <div id="app-container" class="app-container">
            <div class="video-content">
                <div class="player-wrapper">
                    <div id="video-container" class="video-container">
                        <div id="flashcard-display">
                            <div class="flashcard-inner">
                                <div class="flashcard-face front" id="flashcard-front-gif" title="Cevabƒ± sesli s√∂ylemek i√ßin tƒ±kla">
                                    <div class="flashcard-color-glow"></div>
                                    <span class="flashcard-lang-text"></span>
                                </div>
                                <div class="flashcard-face back">
                                   <div id="voice-quiz-container">
                                        <p class="voice-status">Bu GIF'in anlamƒ±nƒ± sesli s√∂yleyin</p>
                                        <div id="mic-animation">
                                            <i class="fa-solid fa-microphone"></i>
                                            <div class="pulse"></div>
                                        </div>
                                        <h3 id="voice-answer-feedback">...</h3>
                                        <div id="voice-quiz-buttons" class="hidden" style="display: flex; gap: 1rem; margin-top: 1rem;">
                                            <button id="check-voice-btn">Cevabƒ±mƒ± S√∂yledim</button>
                                            <button id="pass-voice-btn" class="info-btn">Testi Ge√ß</button>
                                        </div>
                                   </div>
                                </div>
                            </div>
                        </div>

                        <video id="video" crossOrigin="anonymous" style="display: none;"></video>
                        <div id="youtube-player"></div>
                        
                        <div class="controls-container">
                            <div class="progress-container" id="progress-container">
                                <div class="progress-bar">
                                    <div class="progress-buffered" id="progress-buffered"></div>
                                    <div class="progress-played" id="progress-played">
                                        <div class="progress-thumb"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="bottom-controls">
                                <div class="controls-left">
                                    <button class="btn" id="play-pause" data-tooltip="Oynat/Durdur (K)"><i class="fa fa-play"></i></button>
                                    <div class="volume-container">
                                        <button class="btn" id="volume-btn" data-tooltip="Sesi Kapat (M)"><i class="fa fa-volume-high"></i></button>
                                        <div class="volume-slider-container">
                                            <input type="range" id="volume" min="0" max="1" step="0.01" value="1">
                                        </div>
                                    </div>
                                    <span class="timestamp" id="timestamp">00:00 / 00:00</span>
                                </div>
                                <div class="controls-right">
                                    <div class="popup-menu-container">
                                        <button class="btn" id="speed-btn" data-tooltip="Oynatma Hƒ±zƒ±"><i class="fa-solid fa-gauge-high"></i></button>
                                        <div id="speed-menu" class="popup-menu">
                                            <ul>
                                                <li><button data-speed="0.5">0.5x</button></li>
                                                <li><button data-speed="1" class="active">1x (Normal)</button></li>
                                                <li><button data-speed="1.5">1.5x</button></li>
                                                <li><button data-speed="2">2x</button></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <!-- ===== KALƒ∞TE MEN√úS√ú HTML BA≈ûLANGICI ===== -->
                                    <div class="popup-menu-container">
                                        <button class="btn" id="quality-btn" data-tooltip="Kalite" style="display: none;"><i class="fa-solid fa-sliders"></i></button>
                                        <div id="quality-menu" class="popup-menu">
                                            <ul id="quality-list">
                                                <!-- Kalite se√ßenekleri buraya JS ile eklenecek -->
                                            </ul>
                                        </div>
                                    </div>
                                    <!-- ===== KALƒ∞TE MEN√úS√ú HTML SONU ===== -->
                                    <div class="popup-menu-container">
                                        <button class="btn" id="subtitle-btn" data-tooltip="Altyazƒ±lar (C)" style="display: none;"><i class="fa-solid fa-closed-captioning"></i></button>
                                        <div id="subtitle-menu" class="popup-menu"><ul id="subtitle-list"></ul></div>
                                    </div>
                                    <button class="btn" id="theater-btn" data-tooltip="Sinema Modu"><i class="fa-solid fa-rectangle-xmark"></i></button>
                                    <button class="btn" id="settings-btn" data-tooltip="Ayarlar"><i class="fa fa-cog"></i></button>
                                    <button class="btn" id="fullscreen-btn" data-tooltip="Tam Ekran (F)"><i class="fa fa-expand"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="settings-modal-overlay" class="settings-modal-overlay">
                <div id="settings-panel" class="settings-window">
                    <div class="settings-header">
                        <div class="title-and-credit">
                            <h2>Ayarlar & Y√∂netim</h2>
                            <span class="creator-credit">Created byü§çU.Toprak</span>
                        </div>
                        <button id="close-settings-btn" class="btn" data-tooltip="Kapat (Esc)"><i class="fa fa-times"></i></button>
                    </div>
                    <!-- SKOR TABLOSU G√úNCELLEMESƒ∞: Skorlar ve butonlar ayrƒ± gruplandƒ± ve kapatma butonu eklendi -->
                    <div id="scoreboard">
                        <div style="display: flex; gap: 2rem;">
                            <div class="score-item">
                                <span class="score-label">Doƒüru</span>
                                <span id="score-correct" class="score-value correct">0</span>
                            </div>
                            <div class="score-item">
                                <span class="score-label">Yanlƒ±≈ü</span>
                                <span id="score-incorrect" class="score-value incorrect">0</span>
                            </div>
                        </div>
                        <div style="display: flex; gap: 0.5rem; align-items: center;">
                            <button id="reset-score-btn" class="btn" data-tooltip="Skoru Sƒ±fƒ±rla"><i class="fa fa-sync-alt"></i></button>
                            <button id="close-settings-scoreboard-btn" class="btn" data-tooltip="Ayarlarƒ± Kapat"><i class="fa fa-times"></i></button> 
                        </div>
                    </div>
                    <div class="settings-tabs">
                        <button class="tab-button active" data-tab="video-source">Video Kaynaƒüƒ±</button>
                        <button class="tab-button" data-tab="general-settings">Genel</button>
                        <button class="tab-button" data-tab="add-flashcards">Ekle</button>
                        <button class="tab-button" data-tab="automation-settings">Otomasyon</button>
                    </div>
                    <div class="settings-content-wrapper">
                        <div id="video-source" class="tab-content active">
                            <div id="upload-zone">
                                <h3>Yerel Dosya Y√ºkle</h3>
                                <div id="upload-zone-content">
                                    <i class="fa-solid fa-cloud-arrow-up"></i>
                                    <p>Video Dosyasƒ±nƒ± S√ºr√ºkle & Bƒ±rak veya Tƒ±kla</p>
                                </div>
                                <input type="file" id="video-upload" accept="video/*">
                                <div class="separator">VEYA</div>
                                <h3>YouTube'dan Y√ºkle</h3>
                                <div id="youtube-url-container">
                                    <input type="text" id="youtube-url" placeholder="YouTube Video URL'sini yapƒ±≈ütƒ±rƒ±n">
                                    <button id="load-youtube-btn">Y√ºkle</button>
                                </div>
                            </div>
                        </div>

                        <div id="general-settings" class="tab-content">
                            
                            <!-- ===== G√ñR√úN√úM VE ETKƒ∞LE≈ûƒ∞M B√ñL√úM√ú KALDIRILDI ===== -->

                            <h3>Uygulama Verileri</h3>
                            <div class="setting">
                                <div style="display: flex; gap: 10px;">
                                    <button id="import-data-btn" class="info-btn">ƒ∞√ße Aktar (JSON)</button>
                                    <button id="export-data-btn" class="info-btn">Dƒ±≈üa Aktar (JSON)</button>
                                </div>
                                <input type="file" id="import-file-input" class="hidden" accept=".json,application/json">
                            </div>
                            <div class="setting"><button id="reset-all-settings-btn" class="danger-btn">T√ºm Ayarlarƒ± ve Verileri Sƒ±fƒ±rla</button></div>
                        </div>
                        <div id="add-flashcards" class="tab-content">
                            <h3>Toplu Kart Ekle (Basit)</h3>
                             <div class="setting">
                                <label>1. Adƒ±m: GIF Dosyalarƒ±nƒ± Sƒ±rayla Se√ß</label>
                                <button id="bulk-gif-select-btn" class="info-btn">GIF Dosyalarƒ±nƒ± Se√ß</button>
                                <input type="file" id="bulk-gif-input" class="hidden" accept="image/gif" multiple>
                                <ul id="bulk-gif-filenames-list" class="gif-filenames-list"></ul>
                            </div>
                            <div class="setting">
                                <label for="bulk-section-id">2. Adƒ±m: Bilgileri Gir (T√ºm√º ƒ∞√ßin Ge√ßerli)</label>
                                <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                                    <input type="number" id="bulk-section-id" placeholder="B√∂l√ºm No" style="width: 50%;">
                                    <input type="text" id="bulk-language" placeholder="Dil (√ñrn: Chinese)" style="width: 50%;">
                                </div>
                            </div>
                            <div class="setting">
                                <label for="bulk-text-input">3. Adƒ±m: Sorularƒ± Sƒ±rayla Yapƒ±≈ütƒ±r</label>
                                <textarea id="bulk-text-input" rows="8" placeholder="Her satƒ±ra bir soru gelecek ≈üekilde yapƒ±≈ütƒ±rƒ±n. Sƒ±ralama, se√ßtiƒüiniz GIF'lerin sƒ±rasƒ±yla e≈üle≈üecektir."></textarea>
                            </div>
                            <div class="setting">
                                <button id="bulk-add-all-btn">T√ºm Kartlarƒ± Ekle</button>
                            </div>
                        </div>
                        <div id="automation-settings" class="tab-content">
                            <h3>Otomasyon & Zamanlama</h3>
                            <div class="setting"><label for="flashcard-step-delay">Adƒ±mlar Arasƒ± Bekleme (sn)</label><input type="number" id="flashcard-step-delay" min="0" value="0"></div>
                            <div class="setting"><label for="flashcard-auto-interval">Otomatik Flashcard Aralƒ±ƒüƒ± (sn)</label><input type="number" id="flashcard-auto-interval" min="1" value="5"></div>
                            <div class="setting"><button id="toggle-auto-flashcard-btn">Otomatik Modu Ba≈ülat</button></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sƒ∞Zƒ∞N UYGULAMANIZIN ANA JAVASCRIPT'ƒ∞ -->
        <script>
            // --- DOM Element References ---
            const appContainer = document.getElementById('app-container');
            const videoContainer = document.getElementById('video-container');
            const video = document.getElementById('video');
            const uploadZone = document.getElementById('upload-zone');
            const uploadZoneContent = document.getElementById('upload-zone-content');
            const videoUpload = document.getElementById('video-upload');
            const playPauseBtn = document.getElementById('play-pause');
            const progressContainer = document.getElementById('progress-container');
            const progressPlayed = document.getElementById('progress-played');
            const progressBuffered = document.getElementById('progress-buffered');
            const timestamp = document.getElementById('timestamp');
            const settingsBtn = document.getElementById('settings-btn');
            const notificationContainer = document.getElementById('notification-container');
            const modalOverlay = document.getElementById('modal-overlay');
            const modalText = document.getElementById('modal-text');
            const modalButtons = document.querySelector('.modal-buttons');
            const modalConfirmBtn = document.getElementById('modal-confirm-btn');
            const modalCancelBtn = document.getElementById('modal-cancel-btn');
            const flashcardDisplay = document.getElementById('flashcard-display');
            const volumeBtn = document.getElementById('volume-btn');
            const volumeSlider = document.getElementById('volume');
            const fullscreenBtn = document.getElementById('fullscreen-btn');
            const tabButtons = document.querySelectorAll('.settings-tabs .tab-button');
            const tabContents = document.querySelectorAll('.settings-content-wrapper .tab-content');
            const scoreCorrectEl = document.getElementById('score-correct');
            const scoreIncorrectEl = document.getElementById('score-incorrect');
            const resetScoreBtn = document.getElementById('reset-score-btn');
            const resetAllSettingsBtn = document.getElementById('reset-all-settings-btn');
            const youtubeUrlInput = document.getElementById('youtube-url');
            const loadYoutubeBtn = document.getElementById('load-youtube-btn');
            const youtubePlayerDiv = document.getElementById('youtube-player');
            const subtitleBtn = document.getElementById('subtitle-btn');
            const subtitleMenu = document.getElementById('subtitle-menu');
            const subtitleList = document.getElementById('subtitle-list');
            const importDataBtn = document.getElementById('import-data-btn');
            const exportDataBtn = document.getElementById('export-data-btn');
            const importFileInput = document.getElementById('import-file-input');
            const speedBtn = document.getElementById('speed-btn');
            const speedMenu = document.getElementById('speed-menu');
            const theaterBtn = document.getElementById('theater-btn');
            
            // ===== G√ñR√úN√úM AYARI REFERANSLARI KALDIRILDI =====

            const flashcardStepDelayInput = document.getElementById('flashcard-step-delay');
            const flashcardAutoIntervalInput = document.getElementById('flashcard-auto-interval');
            const toggleAutoFlashcardBtn = document.getElementById('toggle-auto-flashcard-btn');
            const bulkGifSelectBtn = document.getElementById('bulk-gif-select-btn');
            const bulkGifInput = document.getElementById('bulk-gif-input');
            const bulkGifFilenamesList = document.getElementById('bulk-gif-filenames-list');
            const bulkTextInput = document.getElementById('bulk-text-input');
            const bulkAddAllBtn = document.getElementById('bulk-add-all-btn');
            const bulkSectionIdInput = document.getElementById('bulk-section-id');
            const bulkLanguageInput = document.getElementById('bulk-language');

            // ===== KALƒ∞TE MEN√úS√ú DOM REFERANSLARI =====
            const qualityBtn = document.getElementById('quality-btn');
            const qualityMenu = document.getElementById('quality-menu');
            const qualityList = document.getElementById('quality-list');


            // Ayarlar Penceresi Referanslarƒ±
            const settingsModalOverlay = document.getElementById('settings-modal-overlay');
            const closeSettingsBtn = document.getElementById('close-settings-btn');
            const settingsPanel = document.getElementById('settings-panel');
            // Yeni buton referansƒ±
            const closeSettingsScoreboardBtn = document.getElementById('close-settings-scoreboard-btn');


            // --- Global Variables ---
            let flashcards = [];
            let languageColors = {}; 
            let currentVideoKey = null;
            let controlsTimeout;
            let currentModalCallback;
            let isFlashcardShowing = false;
            let synth, errorSynth;
            let scoreCorrect = 0;
            let scoreIncorrect = 0;
            let playerMode = 'none';
            let ytPlayer;
            let progressUpdateInterval;
            let lastCheckedTime = 0;
            let isAutoFlashcardActive = false;
            let autoFlashcardDelay = 5;
            let autoPlayQueue = [];
            let autoFlashcardCurrentIndex = 0;
            let lastAutoFlashcardVideoTime = null;
            let flashcardStepDelay = 0;
            let pendingFlashcardStep = null;
            let bulkGifFiles = []; 
            // YouTube API kalite seviyelerini etiketlerle e≈üle≈ütirmek i√ßin
            let qualityMap = {
                "highres": "Y√ºksek √á√∂z.",
                "hd4320": "4320p (8K)",
                "hd2880": "2880p (5K)",
                "hd2160": "2160p (4K)",
                "hd1440": "1440p (2K)",
                "hd1080": "1080p",
                "hd720": "720p",
                "large": "480p",
                "medium": "360p",
                "small": "240p",
                "tiny": "144p",
                "default": "Otomatik"
            };

            // === YOUTUBE API G√úNCELLEMESƒ∞ BA≈ûLANGI√á ===
            let isYouTubeApiReady = false;
            let pendingVideoId = null;

            // Bu fonksiyon, sayfanƒ±n sonundaki YouTube script'i tarafƒ±ndan OTOMATƒ∞K olarak √ßaƒürƒ±lacak
            function onYouTubeIframeAPIReady() {
                isYouTubeApiReady = true;
                // Eƒüer biz API'yi beklerken kullanƒ±cƒ± √ßoktan bir video y√ºklemeye √ßalƒ±≈ütƒ±ysa...
                if (pendingVideoId) {
                    createYtPlayer(pendingVideoId);
                    pendingVideoId = null;
                }
            }
            // === YOUTUBE API G√úNCELLEMESƒ∞ SON ===


            // IndexedDB Helper
            const dbHelper = {
                db: null, DB_NAME: 'GifQuizDB_v3', STORE_NAME: 'gifs',
                init() { return new Promise((resolve, reject) => { const request = indexedDB.open(this.DB_NAME, 1); request.onerror = (event) => { console.error("IndexedDB error:", event.target.error); reject("IndexedDB a√ßƒ±lamadƒ±."); }; request.onsuccess = (event) => { this.db = event.target.result; resolve(); }; request.onupgradeneeded = (event) => { const db = event.target.result; if (!db.objectStoreNames.contains(this.STORE_NAME)) { db.createObjectStore(this.STORE_NAME, { keyPath: 'id' }); } }; }); },
                addGif(id, blob) { return new Promise((resolve, reject) => { if (!this.db) return reject("Veritabanƒ± ba≈ülatƒ±lmadƒ±."); const transaction = this.db.transaction([this.STORE_NAME], 'readwrite'); const store = transaction.objectStore(this.STORE_NAME); const request = store.put({ id: id, blob: blob }); request.onsuccess = () => resolve(); request.onerror = (event) => reject("GIF eklenemedi: " + event.target.error); }); },
                getGif(id) { return new Promise((resolve, reject) => { if (!this.db) return reject("Veritabanƒ± ba≈ülatƒ±lmadƒ±."); const transaction = this.db.transaction([this.STORE_NAME], 'readonly'); const store = transaction.objectStore(this.STORE_NAME); const request = store.get(id); request.onsuccess = (event) => resolve(event.target.result ? event.target.result.blob : null); request.onerror = (event) => reject("GIF alƒ±namadƒ±: " + event.target.error); }); },
                deleteGif(id) { return new Promise((resolve, reject) => { if (!this.db) return reject("Veritabanƒ± ba≈ülatƒ±lmadƒ±."); const transaction = this.db.transaction([this.STORE_NAME], 'readwrite'); const store = transaction.objectStore(this.STORE_NAME); const request = store.delete(id); request.onsuccess = () => resolve(); request.onerror = (event) => reject("GIF silinemedi: " + event.target.error); }); },
                clearGifs(ids) { return new Promise((resolve, reject) => { if (!this.db) return reject("Veritabanƒ± ba≈ülatƒ±lmadƒ±."); const transaction = this.db.transaction([this.STORE_NAME], 'readwrite'); const store = transaction.objectStore(this.STORE_NAME); if (ids.length === 0) return resolve(); let count = 0; ids.forEach(id => { store.delete(id).onsuccess = () => { if (++count === ids.length) resolve(); }; }); }); }
            };

            // --- Helper Functions ---
            const showToast = (message, type = 'info') => { const toast = document.createElement('div'); toast.className = `toast ${type}`; toast.textContent = message; notificationContainer.appendChild(toast); setTimeout(() => toast.remove(), 4500); };
            const showModal = (text, callback) => { modalText.innerHTML = text; currentModalCallback = callback; modalButtons.style.display = callback ? 'flex' : 'none'; modalOverlay.classList.add('show'); };
            const hideModal = () => { modalOverlay.classList.remove('show'); currentModalCallback = null; };
            function shuffleArray(array) { for (let i = array.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [array[i], array[j]] = [array[j], array[i]]; } return array; }
            async function dataURLtoBlob(dataurl) { const res = await fetch(dataurl); return await res.blob(); }
            function blobToDataURL(blob) { return new Promise((resolve, reject) => { const reader = new FileReader(); reader.onload = () => resolve(reader.result); reader.onerror = reject; reader.readAsDataURL(blob); }); }
            
            // --- Score & Data Functions ---
            function updateScoreDisplay() { scoreCorrectEl.textContent = scoreCorrect; scoreIncorrectEl.textContent = scoreIncorrect; }
            const saveData = () => {
                try {
                    if (currentVideoKey) {
                        localStorage.setItem(`flashcards_${currentVideoKey}`, JSON.stringify(flashcards));
                        localStorage.setItem(`scoreCorrect_${currentVideoKey}`, scoreCorrect);
                        localStorage.setItem(`scoreIncorrect_${currentVideoKey}`, scoreIncorrect);
                    }
                    localStorage.setItem('languageColors', JSON.stringify(languageColors));
                    // ===== G√ñR√úN√úM AYARI KAYITLARI KALDIRILDI =====
                    localStorage.setItem('flashcard-step-delay', flashcardStepDelayInput.value);
                    localStorage.setItem('flashcard-auto-interval', flashcardAutoIntervalInput.value);
                } catch (e) { showToast('Veriler kaydedilemedi.', 'error'); }
            };
            const loadFlashcardsForVideo = (key) => {
                try {
                    const storedFlashcards = localStorage.getItem(`flashcards_${key}`);
                    flashcards = storedFlashcards ? JSON.parse(storedFlashcards) : [];
                    if (!Array.isArray(flashcards)) flashcards = [];
                    flashcards.forEach(card => { card.shown = false; card.answered = false; }); 
                    if (storedFlashcards) showToast(`${flashcards.length} adet flashcard bu video i√ßin y√ºklendi.`, 'info');
                    scoreCorrect = parseInt(localStorage.getItem(`scoreCorrect_${key}`) || '0', 10);
                    scoreIncorrect = parseInt(localStorage.getItem(`scoreIncorrect_${key}`) || '0', 10);
                    updateScoreDisplay();
                } catch (e) { 
                    flashcards = []; 
                    scoreCorrect = 0; 
                    scoreIncorrect = 0; 
                    updateScoreDisplay(); 
                }
            };

            // ===== G√ñR√úN√úM AYARI FONKSƒ∞YONLARI KALDIRILDI (applyFlashcardStyles, hexToRgb) =====

            function initializeSettings() {
                const storedLangColors = localStorage.getItem('languageColors');
                if (storedLangColors) {
                    languageColors = JSON.parse(storedLangColors);
                }

                const settings = [
                    // ===== G√ñR√úN√úM AYARLARI Lƒ∞STEDEN KALDIRILDI =====
                    { key: 'flashcard-step-delay', el: flashcardStepDelayInput, target: window, prop: 'flashcardStepDelay' },
                    { key: 'flashcard-auto-interval', el: flashcardAutoIntervalInput, target: window, prop: 'autoFlashcardDelay' }
                ];
                settings.forEach(setting => {
                    const storedValue = localStorage.getItem(setting.key);
                    if (storedValue) {
                        setting.el.value = storedValue;
                        if (setting.target === window) { window[setting.prop] = parseInt(storedValue, 10); }
                        if (setting.valueSpan) { setting.valueSpan.textContent = storedValue + setting.unit; }
                    }
                });
                // ===== applyFlashcardStyles() √áAƒûRISI KALDIRILDI =====
            }

            // --- Control Visibility & Player State ---
            const showControls = () => videoContainer.classList.add('controls-visible');
            
            // === JS G√úNCELLEMESƒ∞ BA≈ûLANGIICI: Kontrollerin erken gizlenmesini d√ºzelt ===
            const hideControls = () => {
                // YouTube API'si hazƒ±r deƒüilse veya ytPlayer nesnesi hen√ºz olu≈ümadƒ±ysa
                // getPlayerState fonksiyonunu √ßaƒüƒ±ramayƒ±z, bu y√ºzden kontrolleri gizleme.
                if (playerMode === 'youtube' && (!isYouTubeApiReady || !ytPlayer || typeof ytPlayer.getPlayerState !== 'function')) {
                    return; 
                }

                const isPaused = (playerMode === 'local' && video.paused) || 
                                 (playerMode === 'youtube' && ytPlayer.getPlayerState() !== YT.PlayerState.PLAYING);
                
                // ===== KALƒ∞TE MEN√úS√ú KONTROL√ú EKLENDƒ∞ =====
                if (isPaused || settingsModalOverlay.classList.contains('show') || isFlashcardShowing || subtitleMenu.classList.contains('show') || speedMenu.classList.contains('show') || qualityMenu.classList.contains('show') || modalOverlay.classList.contains('show')) {
                    return;
                }
                videoContainer.classList.remove('controls-visible');
            };
            // === JS G√úNCELLEMESƒ∞ SONU ===

            const resetControlsTimeout = () => {
                videoContainer.classList.remove('cursor-hidden'); clearTimeout(controlsTimeout); showControls();
                controlsTimeout = setTimeout(() => {
                    hideControls();
                    
                    // hideControls i√ßinde zaten API hazƒ±r olma kontrol√º var, ancak burada tekrar kontrol edelim.
                    let isPaused = false;
                    if (playerMode === 'local') {
                        isPaused = video.paused;
                    } else if (playerMode === 'youtube' && ytPlayer && typeof ytPlayer.getPlayerState === 'function') {
                        isPaused = ytPlayer.getPlayerState() !== YT.PlayerState.PLAYING;
                    }
                    
                    if (!isPaused && !isFlashcardShowing) videoContainer.classList.add('cursor-hidden');
                }, 3000);
            };
            function resetPlayerState() {
                video.pause(); video.src = ''; video.style.display = 'none';
                if (ytPlayer) { ytPlayer.destroy(); ytPlayer = null; }
                youtubePlayerDiv.innerHTML = ''; 
                subtitleBtn.style.display = 'none'; 
                subtitleMenu.classList.remove('show'); 
                subtitleList.innerHTML = '';
                // ===== KALƒ∞TE MEN√úS√ú SIFIRLAMA =====
                qualityBtn.style.display = 'none';
                qualityMenu.classList.remove('show');
                qualityList.innerHTML = '';
                // ====================================
                playerMode = 'none'; currentVideoKey = null; stopAutoFlashcard(); clearInterval(progressUpdateInterval);
                flashcards = []; scoreCorrect = 0; scoreIncorrect = 0;
                updateScoreDisplay();
                openSettingsModal();
                const targetTab = 'video-source';
                tabButtons.forEach(btn => btn.classList.toggle('active', btn.dataset.tab === targetTab));
                tabContents.forEach(content => content.classList.toggle('active', content.id === targetTab));
            }
            const handleFileSelect = (file) => {
                if (file && file.type.startsWith('video/')) {
                    resetPlayerState(); // YouTube oynatƒ±cƒ±yƒ± temizle
                    playerMode = 'local';
                    video.src = URL.createObjectURL(file); video.style.display = 'block';
                    document.title = file.name;
                    currentVideoKey = `local_${file.name}-${file.size}`;
                    loadFlashcardsForVideo(currentVideoKey);
                    closeSettingsModal();
                } else { showToast('L√ºtfen ge√ßerli bir video dosyasƒ± se√ßin.', 'error'); }
            };
            function getYouTubeId(url) { const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/; const match = url.match(regExp); return (match && match[2].length === 11) ? match[2] : null; }
            
            // === YOUTUBE API G√úNCELLEMESƒ∞ BA≈ûLANGI√á ===
            function loadYouTubeVideo() {
                const videoId = getYouTubeId(youtubeUrlInput.value);
                if (videoId) {
                    resetPlayerState(); // Yerel videoyu temizle
                    playerMode = 'youtube'; 
                    currentVideoKey = `yt_${videoId}`;
                    
                    if (isYouTubeApiReady) {
                        // API zaten hazƒ±r, oynatƒ±cƒ±yƒ± hemen olu≈ütur
                        createYtPlayer(videoId);
                    } else {
                        // API hen√ºz hazƒ±r deƒüil, ID'yi beklemeye al
                        // onYouTubeIframeAPIReady fonksiyonu hazƒ±r olduƒüunda bunu √ßalƒ±≈ütƒ±racak
                        pendingVideoId = videoId;
                        showToast('YouTube API hazƒ±rlanƒ±yor...', 'info');
                    }
                    closeSettingsModal();
                } else { showToast('Ge√ßersiz YouTube URL\'si.', 'error'); }
            }

            function createYtPlayer(videoId) { 
                // Oynatƒ±cƒ±yƒ± olu≈üturmadan √∂nce alanƒ± temizle
                if (ytPlayer) {
                    ytPlayer.destroy();
                    ytPlayer = null;
                }
                youtubePlayerDiv.innerHTML = ''; // DIV i√ßeriƒüini temizle

                ytPlayer = new YT.Player('youtube-player', { 
                    height: '100%', 
                    width: '100%', 
                    videoId: videoId, 
                    playerVars: { 
                        'playsinline': 1, 
                        'controls': 0, 
                        'rel': 0, 
                        'showinfo': 0, 
                        'modestbranding': 1, 
                        'cc_load_policy': 1 
                    }, 
                    events: { 
                        'onReady': onPlayerReady, 
                        'onStateChange': onPlayerStateChange, 
                        'onApiChange': onApiChange,
                        'onPlaybackQualityChange': onPlaybackQualityChange // ===== KALƒ∞TE EVENTƒ∞ EKLENDƒ∞ =====
                    } 
                }); 
            }
            // === YOUTUBE API G√úNCELLEMESƒ∞ SON ===
            
            function onPlayerReady(event) { 
                loadFlashcardsForVideo(currentVideoKey); 
                document.title = event.target.getVideoData().title; 
                updateVolumeIcon(); 
                loadSubtitles(); 
                loadQualityLevels(); // ===== KALƒ∞TE SEVƒ∞YELERƒ∞Nƒ∞ Y√úKLE =====
                setPlaybackSpeed(1); 
                // Oynatƒ±cƒ± hazƒ±r olduƒüunda, kontrollerin durumunu
                // hemen deƒüerlendirmek i√ßin timeout'u sƒ±fƒ±rla.
                resetControlsTimeout();
            }
            function onPlayerStateChange(event) {
                updatePlayIcon();
                if (event.data === YT.PlayerState.PLAYING) { 
                    clearInterval(progressUpdateInterval); 
                    progressUpdateInterval = setInterval(updateProgress, 250); 
                    // Oynatma ba≈üladƒ±ƒüƒ±nda kontrolleri gizlemek i√ßin timeout'u sƒ±fƒ±rla
                    resetControlsTimeout();
                } 
                else { 
                    clearInterval(progressUpdateInterval); 
                    // Durakladƒ±ƒüƒ±nda kontrolleri g√∂ster
                    showControls();
                }
                if (event.data === YT.PlayerState.ENDED) { 
                    showToast('Video bitti!', 'info'); 
                }
            }
            function onApiChange() { 
                if (playerMode === 'youtube') { 
                    updateSubtitleActiveState(); 
                    loadQualityLevels(); // API deƒüi≈ütiƒüinde kalite seviyelerini yeniden y√ºkle
                } 
            }

            // --- Subtitle & Speed Functions ---
            function loadSubtitles() { if (!ytPlayer || typeof ytPlayer.getOptions !== 'function') return; setTimeout(() => { const tracks = ytPlayer.getOptions('captions'); if (tracks && tracks.length > 0) { subtitleBtn.style.display = 'flex'; populateSubtitleMenu(tracks); updateSubtitleActiveState(); } else { subtitleBtn.style.display = 'none'; } }, 1000); }
            function populateSubtitleMenu(tracks) { subtitleList.innerHTML = '<li><button data-lang="">Altyazƒ± Kapalƒ±</button></li>'; tracks.forEach(track => { subtitleList.innerHTML += `<li><button data-lang="${track.languageCode}">${track.displayName}</button></li>`; }); subtitleList.querySelectorAll('button').forEach(btn => btn.onclick = handleSubtitleSelection); }
            function handleSubtitleSelection(event) { const langCode = event.target.dataset.lang; ytPlayer.loadModule('captions'); ytPlayer.setOption('captions', 'track', langCode ? {'languageCode': langCode} : {}); subtitleMenu.classList.remove('show'); }
            function updateSubtitleActiveState() { if (!ytPlayer || typeof ytPlayer.getOption !== 'function') return; const currentTrack = ytPlayer.getOption('captions', 'track'); const activeLangCode = (currentTrack && Object.keys(currentTrack).length > 0) ? currentTrack.languageCode : ''; subtitleList.querySelectorAll('button').forEach(btn => btn.classList.toggle('active', btn.dataset.lang === activeLangCode)); subtitleBtn.classList.toggle('active', !!activeLangCode); }
            function setPlaybackSpeed(speed) { if (playerMode === 'local') video.playbackRate = speed; else if (playerMode === 'youtube' && typeof ytPlayer.setPlaybackRate === 'function') ytPlayer.setPlaybackRate(speed); speedMenu.querySelectorAll('button').forEach(btn => btn.classList.toggle('active', parseFloat(btn.dataset.speed) === speed)); }

            // ===== YENƒ∞ KALƒ∞TE FONKSƒ∞YONLARI BA≈ûLANGI√á =====
            function onPlaybackQualityChange(event) {
                updateQualityActiveState(event.data);
            }

            function loadQualityLevels() {
                if (!ytPlayer || typeof ytPlayer.getAvailableQualityLevels !== 'function') return;

                const availableLevels = ytPlayer.getAvailableQualityLevels();
                const currentQuality = ytPlayer.getPlaybackQuality();

                if (availableLevels && availableLevels.length > 0) {
                    qualityBtn.style.display = 'flex';
                    populateQualityMenu(availableLevels, currentQuality);
                } else {
                    qualityBtn.style.display = 'none';
                }
            }

            function populateQualityMenu(levels, currentQuality) {
                qualityList.innerHTML = '';
                
                // "Otomatik" se√ßeneƒüini ekle
                const autoBtn = document.createElement('button');
                autoBtn.textContent = qualityMap["default"];
                autoBtn.dataset.quality = "default";
                autoBtn.onclick = handleQualitySelection;
                const autoLi = document.createElement('li');
                autoLi.appendChild(autoBtn);
                qualityList.appendChild(autoLi);

                // Diƒüer seviyeleri (ters sƒ±rada, en y√ºksekten en d√º≈ü√ºƒüe) ekle
                levels.forEach(level => {
                    const btn = document.createElement('button');
                    btn.textContent = qualityMap[level] || level;
                    btn.dataset.quality = level;
                    btn.onclick = handleQualitySelection;
                    
                    const li = document.createElement('li');
                    li.appendChild(btn);
                    qualityList.appendChild(li);
                });

                updateQualityActiveState(currentQuality || "default");
            }

            // ===== FONKSƒ∞YON G√úNCELLENDƒ∞ (updateQualityActiveState EKLENDƒ∞) =====
            function handleQualitySelection(event) {
                const quality = event.target.dataset.quality;
                if (ytPlayer && typeof ytPlayer.setPlaybackQuality === 'function') {
                    ytPlayer.setPlaybackQuality(quality);
                    // Kullanƒ±cƒ±nƒ±n tƒ±kladƒ±ƒüƒ± se√ßeneƒüi hemen "active" olarak i≈üaretle.
                    // API'den onay geldiƒüinde 'onPlaybackQualityChange' bunu gerekirse g√ºncelleyecektir.
                    updateQualityActiveState(quality);
                }
                qualityMenu.classList.remove('show');
            }
            // ===============================================================

            function updateQualityActiveState(currentQuality) {
                qualityList.querySelectorAll('button').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.quality === currentQuality);
                });
            }
            // ===== YENƒ∞ KALƒ∞TE FONKSƒ∞YONLARI SONU =====


            // --- Flashcard & Quiz Logic ---
            const showFlashcard = async (card) => {
                if (isFlashcardShowing || pendingFlashcardStep) return;
                isFlashcardShowing = true; 
                pauseVideo();

                const frontFace = document.getElementById('flashcard-front-gif');
                const colorGlow = frontFace.querySelector('.flashcard-color-glow');
                const langText = frontFace.querySelector('.flashcard-lang-text');
                
                const existingImg = frontFace.querySelector('img');
                if (existingImg) existingImg.remove();
                const existingError = frontFace.querySelector('p');
                if (existingError) existingError.remove();

                langText.textContent = card.language || '';
                
                const langColor = languageColors[card.language?.toLowerCase()] || 'transparent';
                colorGlow.style.backgroundColor = langColor;

                if (card.language) {
                    langText.style.display = 'block';
                } else {
                    langText.style.display = 'none';
                }

                try {
                    const gifBlob = await dbHelper.getGif(card.back);
                    if (gifBlob) {
                        const url = URL.createObjectURL(gifBlob);
                        const img = document.createElement('img');
                        img.src = url;
                        img.style.width = '100%';
                        img.style.height = '100%';
                        img.style.objectFit = 'contain';
                        img.onload = () => URL.revokeObjectURL(url);
                        frontFace.appendChild(img);
                    } else {
                        frontFace.insertAdjacentHTML('beforeend', '<p>GIF Y√ºklenemedi</p>');
                    }
                } catch (error) {
                    frontFace.insertAdjacentHTML('beforeend', '<p>Hata</p>');
                }
                
                setupFakeVoiceQuiz(card);

                flashcardDisplay.classList.remove('reveal');
                flashcardDisplay.classList.add('show');
                showControls();
                videoContainer.classList.remove('cursor-hidden');
            };

            const checkFlashcards = () => {
                if (isAutoFlashcardActive || isFlashcardShowing || pendingFlashcardStep) return;
                const currentTime = getCurrentTime(); 
                if (currentTime === null) return;

                const sortedFlashcards = [...flashcards].sort((a, b) => {
                    if (a.time !== b.time) return a.time - b.time;
                    if (a.bulkOrder !== undefined && b.bulkOrder !== undefined) return a.bulkOrder - b.bulkOrder;
                    return (a.sectionId || 0) - (b.sectionId || 0);
                });

                for (let card of sortedFlashcards) {
                    if (!card.shown && card.time > lastCheckedTime && card.time <= currentTime) {
                        card.shown = true;
                        showFlashcard(card);
                        lastCheckedTime = card.time;
                        return; 
                    }
                }
                lastCheckedTime = currentTime;
            };

            const startIntermediatePlayback = () => {
                if (flashcardStepDelay > 0) {
                    isFlashcardShowing = false; flashcardDisplay.classList.remove('show');
                    const currentTime = getCurrentTime();
                    pendingFlashcardStep = { triggerTime: currentTime + flashcardStepDelay };
                    playVideo();
                } else { showAnswerQuiz(); }
            };
            const showAnswerQuiz = () => { isFlashcardShowing = true; pauseVideo(); flashcardDisplay.classList.add('show', 'reveal'); pendingFlashcardStep = null; };
            
            const setupFakeVoiceQuiz = (card) => {
                const feedbackEl = document.getElementById('voice-answer-feedback');
                const micAnimation = document.getElementById('mic-animation');
                const buttonContainer = document.getElementById('voice-quiz-buttons');
                const checkBtn = document.getElementById('check-voice-btn');
                const passBtn = document.getElementById('pass-voice-btn');

                feedbackEl.textContent = '...';
                feedbackEl.className = '';
                micAnimation.classList.remove('recording', 'analyzing');
                buttonContainer.classList.add('hidden');

                micAnimation.classList.add('recording');
                
                setTimeout(() => {
                    buttonContainer.classList.remove('hidden');
                }, 2000);

                const newCheckBtn = checkBtn.cloneNode(true);
                checkBtn.parentNode.replaceChild(newCheckBtn, checkBtn);
                const newPassBtn = passBtn.cloneNode(true);
                passBtn.parentNode.replaceChild(newPassBtn, passBtn);

                const handleCorrectAnswer = () => {
                    micAnimation.classList.remove('recording', 'analyzing');
                    feedbackEl.textContent = `Doƒüru! Cevap: "${card.original}"`;
                    feedbackEl.classList.add('correct');
                    if (synth) synth.triggerAttackRelease("C5", "8n");
                    
                    if (!card.answered) {
                        scoreCorrect++;
                        card.answered = true;
                    }
                    updateScoreDisplay(); 
                    saveData();

                    setTimeout(() => {
                        isFlashcardShowing = false;
                        flashcardDisplay.classList.remove('show', 'reveal');
                        
                        if (isAutoFlashcardActive) {
                            lastAutoFlashcardVideoTime = getCurrentTime();
                        }

                        playVideo();
                        const currentCheckBtn = document.getElementById('check-voice-btn');
                        const currentPassBtn = document.getElementById('pass-voice-btn');
                        if(currentCheckBtn) currentCheckBtn.disabled = false;
                        if(currentPassBtn) currentPassBtn.disabled = false;
                    }, 2500);
                };

                newCheckBtn.onclick = (e) => {
                    e.stopPropagation();
                    micAnimation.classList.remove('recording');
                    micAnimation.classList.add('analyzing');
                    feedbackEl.textContent = 'Analiz ediliyor...';
                    newCheckBtn.disabled = true;
                    newPassBtn.disabled = true;
                    
                    setTimeout(handleCorrectAnswer, 1500);
                };

                newPassBtn.onclick = (e) => {
                    e.stopPropagation();
                    newCheckBtn.disabled = true;
                    newPassBtn.disabled = true;
                    handleCorrectAnswer();
                };
            };


            // --- Auto Mode & Quiz Flow ---
            const startAutoFlashcard = () => {
                if (playerMode === 'none') return showToast('√ñnce bir video y√ºkleyin.', 'error');
                if (flashcards.length === 0) return showToast('Ba≈ülatmak i√ßin en az bir flashcard ekleyin.', 'info');
                
                autoPlayQueue = [...flashcards]; autoFlashcardCurrentIndex = 0; isAutoFlashcardActive = true;
                toggleAutoFlashcardBtn.textContent = 'Otomatik Modu Durdur'; toggleAutoFlashcardBtn.style.backgroundColor = 'var(--danger-color)';
                playVideo(); lastAutoFlashcardVideoTime = getCurrentTime(); 
                showToast(`Otomatik mod ba≈ülatƒ±ldƒ±. ƒ∞lk kart ${autoFlashcardDelay} saniye sonra belirecek.`, 'info');
            };
            
            const stopAutoFlashcard = () => {
                if (!isAutoFlashcardActive) return;
                const wasJustCompleted = autoFlashcardCurrentIndex >= autoPlayQueue.length;
                isAutoFlashcardActive = false; 
                toggleAutoFlashcardBtn.textContent = 'Otomatik Modu Ba≈ülat';
                toggleAutoFlashcardBtn.style.backgroundColor = 'var(--brand-color)';
                if (!wasJustCompleted && !modalOverlay.classList.contains('show')) {
                    showToast('Otomatik mod durduruldu.', 'info');
                }
            };

            const triggerNextAutoFlashcard = () => {
                const isPausedCheck = (playerMode === 'local') ? video.paused : (ytPlayer.getPlayerState() !== YT.PlayerState.PLAYING);
                if (!isAutoFlashcardActive || isPausedCheck || isFlashcardShowing || pendingFlashcardStep) return;
                if (autoFlashcardCurrentIndex >= autoPlayQueue.length) { 
                    stopAutoFlashcard(); 
                    showToast('Otomatik mod tamamlandƒ±!', 'success');
                    return; 
                }
                const card = autoPlayQueue[autoFlashcardCurrentIndex];
                if(card) { 
                    card.shown = true;
                    showFlashcard(card); 
                    autoFlashcardCurrentIndex++; 
                }
            };
            
            // --- Player Control Functions ---
            function playVideo() { if (playerMode === 'local') video.play(); else if (playerMode === 'youtube' && ytPlayer) ytPlayer.playVideo(); }
            function pauseVideo() { if (playerMode === 'local') video.pause(); else if (playerMode === 'youtube' && ytPlayer) ytPlayer.pauseVideo(); }
            function togglePlay() { 
                if (playerMode === 'none' || isFlashcardShowing) return; 
                // API'nin hazƒ±r olduƒüundan emin ol
                if (playerMode === 'youtube' && (!ytPlayer || typeof ytPlayer.getPlayerState !== 'function')) return;
                const isPausedCheck = (playerMode === 'local') ? video.paused : (ytPlayer.getPlayerState() !== YT.PlayerState.PLAYING); 
                isPausedCheck ? playVideo() : pauseVideo(); 
            }
            function getCurrentTime() { if (playerMode === 'local') return video.currentTime; if (playerMode === 'youtube' && ytPlayer && typeof ytPlayer.getCurrentTime === 'function') return ytPlayer.getCurrentTime(); return null; }
            function getDuration() { if (playerMode === 'local') return video.duration; if (playerMode === 'youtube' && typeof ytPlayer.getDuration === 'function') return ytPlayer.getDuration(); return 0; }
            function seekTo(time) { if (playerMode === 'local') video.currentTime = time; else if (playerMode === 'youtube' && ytPlayer) ytPlayer.seekTo(time, true); lastCheckedTime = time; }
            function getBufferedEnd() { if (playerMode === 'local' && video.buffered.length > 0) return video.buffered.end(video.buffered.length - 1); if (playerMode === 'youtube' && ytPlayer) return ytPlayer.getVideoLoadedFraction() * getDuration(); return 0; }
            
            // --- UI Control Functions ---
            const updatePlayIcon = () => { 
                // API hazƒ±r deƒüilse varsayƒ±lan olarak 'play' ikonunu g√∂ster
                if (playerMode === 'youtube' && (!ytPlayer || typeof ytPlayer.getPlayerState !== 'function')) {
                    playPauseBtn.querySelector('i').className = 'fa fa-play';
                    return;
                }
                const isPaused = (playerMode === 'local') ? video.paused : (ytPlayer.getPlayerState() !== YT.PlayerState.PLAYING); 
                playPauseBtn.querySelector('i').className = `fa fa-${isPaused ? 'play' : 'pause'}`; 
            };
            const skip = (sec) => { if (playerMode === 'none' || isFlashcardShowing) return; const currentTime = getCurrentTime(); if (currentTime !== null) seekTo(currentTime + sec); };
            function updateProgressUI(currentTime, duration, bufferedEnd) {
                if (isNaN(duration) || duration <= 0) return;
                progressPlayed.style.width = `${(currentTime / duration) * 100}%`; progressBuffered.style.width = `${(bufferedEnd / duration) * 100}%`;
                const formatTime = t => `${String(Math.floor(t/60)).padStart(2,'0')}:${String(Math.floor(t%60)).padStart(2,'0')}`;
                timestamp.textContent = `${formatTime(currentTime)} / ${formatTime(duration)}`;
            }
            const updateProgress = () => {
                const currentTime = getCurrentTime(); const duration = getDuration(); const bufferedEnd = getBufferedEnd();
                if (currentTime === null || isNaN(duration)) return;
                updateProgressUI(currentTime, duration, bufferedEnd);
                if (pendingFlashcardStep && currentTime >= pendingFlashcardStep.triggerTime) { showAnswerQuiz(); }
                if (!isAutoFlashcardActive) checkFlashcards();
                else if (lastAutoFlashcardVideoTime !== null && (currentTime - lastAutoFlashcardVideoTime >= autoFlashcardDelay)) { triggerNextAutoFlashcard(); }
            };
            const setProgress = (e) => {
                if (playerMode === 'none' || isNaN(getDuration()) || isFlashcardShowing) return;
                const newTime = (e.offsetX / progressContainer.clientWidth) * getDuration(); seekTo(newTime);
                flashcards.forEach(card => { card.shown = false; card.answered = false; });
            };
            const toggleMute = () => { if (playerMode === 'local') video.muted = !video.muted; else if (playerMode === 'youtube' && ytPlayer) ytPlayer.isMuted() ? ytPlayer.unMute() : ytPlayer.mute(); };
            const updateVolumeIcon = () => {
                let muted, volume;
                if(playerMode === 'local') { muted = video.muted; volume = video.volume; } 
                else if (playerMode === 'youtube' && ytPlayer && typeof ytPlayer.getVolume === 'function') { muted = ytPlayer.isMuted(); volume = ytPlayer.getVolume() / 100; } 
                else return;
                volumeSlider.value = muted ? 0 : volume; const icon = volumeBtn.querySelector('i');
                if (muted || volume === 0) icon.className = 'fa fa-volume-xmark';
                else if (volume < 0.5) icon.className = 'fa fa-volume-low';
                else icon.className = 'fa fa-volume-high';
            };
            const toggleFullscreen = () => { if (!document.fullscreenElement) appContainer.requestFullscreen().catch(err => console.error(err)); else document.exitFullscreen(); };
            const toggleTheaterMode = () => { appContainer.classList.toggle('theater-mode'); const icon = theaterBtn.querySelector('i'); icon.className = appContainer.classList.contains('theater-mode') ? 'fa-solid fa-compress' : 'fa-solid fa-rectangle-xmark'; };

            const handleVisibilityChange = () => {
                if (document.hidden) {
                    // API hazƒ±r olma kontrol√º
                    if (playerMode === 'youtube' && (!ytPlayer || typeof ytPlayer.getPlayerState !== 'function')) return;
                    
                    const isPlaying = (playerMode === 'local' && !video.paused) || 
                                      (playerMode === 'youtube' && ytPlayer.getPlayerState() === YT.PlayerState.PLAYING);
                    if (isPlaying) {
                        pauseVideo();
                    }
                }
            };

            // --- Data Import/Export ---
            async function exportData() {
                if (!currentVideoKey) return showToast('Dƒ±≈üa aktarmak i√ßin √∂nce bir video y√ºkleyin.', 'error');
                if (flashcards.length === 0) return showToast('Dƒ±≈üa aktarƒ±lacak flashcard bulunmuyor.', 'info');
                showToast('Veriler hazƒ±rlanƒ±yor...', 'info');
                try {
                    const flashcardsWithData = await Promise.all(flashcards.map(async (card) => { const gifBlob = await dbHelper.getGif(card.back); const dataUrl = gifBlob ? await blobToDataURL(gifBlob) : null; return { ...card, back: dataUrl }; }));
                    const dataToExport = { videoKey: currentVideoKey, flashcards: flashcardsWithData, score: { correct: scoreCorrect, incorrect: scoreIncorrect } };
                    const blob = new Blob([JSON.stringify(dataToExport, null, 2)], { type: 'application/json' });
                    const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = `flashcard_backup_${currentVideoKey}.json`; a.click(); URL.revokeObjectURL(a.href);
                    showToast('Veriler ba≈üarƒ±yla dƒ±≈üa aktarƒ±ldƒ±.', 'success');
                } catch (error) { showToast('Veriler dƒ±≈üa aktarƒ±lamadƒ±: ' + error, 'error'); }
            }
            async function handleImportedData(data) {
                if (!data.videoKey || !Array.isArray(data.flashcards)) return showToast('Ge√ßersiz dosya formatƒ±.', 'error');
                showModal(`Veriler i√ße aktarƒ±lacak. Mevcut verilerin √ºzerine yazƒ±lacak. Onaylƒ±yor musunuz?`, async () => {
                    hideModal(); showToast('Veriler i√ße aktarƒ±lƒ±yor...', 'info');
                    try {
                        await dbHelper.clearGifs(flashcards.map(f => f.back));
                        const newFlashcards = await Promise.all(data.flashcards.map(async (card) => {
                            if (card.back && card.back.startsWith('data:image/gif')) { const blob = await dataURLtoBlob(card.back); const newId = crypto.randomUUID(); await dbHelper.addGif(newId, blob); return { ...card, back: newId }; }
                            return card;
                        }));
                        flashcards = newFlashcards; 
                        scoreCorrect = data.score?.correct || 0; 
                        scoreIncorrect = data.score?.incorrect || 0;
                        flashcards.forEach(c => { c.shown = false; c.answered = false; });
                        updateScoreDisplay();
                        saveData();
                        showToast('Veriler ba≈üarƒ±yla i√ße aktarƒ±ldƒ±.', 'success');
                    } catch (error) { showToast('Veriler i√ße aktarƒ±lamadƒ±: ' + error, 'error'); }
                });
            }
            
            // --- Toplu Ekleme Fonksiyonlarƒ± ---
            const handleBulkGifSelection = (e) => {
                bulkGifFiles = []; 
                bulkGifFilenamesList.innerHTML = '';
                const files = e.target.files;
                if (!files) return;

                bulkGifFiles = Array.from(files);

                for (const file of bulkGifFiles) {
                    const li = document.createElement('li');
                    li.textContent = file.name;
                    bulkGifFilenamesList.appendChild(li);
                }
                showToast(`${bulkGifFiles.length} GIF se√ßildi.`, 'info');
            };

            const handleAddAllCards = async () => {
                if (playerMode === 'none') return showToast('√ñnce bir video y√ºkleyin.', 'error');
                
                const bulkSection = bulkSectionIdInput.value.trim();
                const bulkLanguage = bulkLanguageInput.value.trim();
                const lines = bulkTextInput.value.trim().split('\n').filter(line => line.trim() !== '');

                if (bulkGifFiles.length === 0) return showToast('L√ºtfen √∂nce GIF dosyalarƒ±nƒ± se√ßin.', 'warning');
                if (lines.length === 0) return showToast('L√ºtfen eklenecek sorularƒ± girin.', 'warning');
                if (bulkGifFiles.length !== lines.length) {
                    return showToast(`GIF sayƒ±sƒ± (${bulkGifFiles.length}) ile soru sayƒ±sƒ± (${lines.length}) e≈üle≈ümiyor.`, 'error');
                }
                if (!bulkSection || !bulkLanguage) {
                    return showToast('L√ºtfen t√ºm kartlar i√ßin "B√∂l√ºm No" ve "Dil" girin.', 'warning');
                }

                let addedCount = 0;
                const errors = [];
                const baseTime = getCurrentTime() || 0;
                const sectionId = parseInt(bulkSection, 10);

                if (isNaN(sectionId)) {
                    return showToast('L√ºtfen ge√ßerli bir B√∂l√ºm No girin.', 'error');
                }

                for (let i = 0; i < bulkGifFiles.length; i++) {
                    const gifFile = bulkGifFiles[i];
                    const original = lines[i].trim();

                    if (!original) {
                        errors.push(`Satƒ±r ${i + 1} bo≈ü olamaz.`);
                        continue;
                    }

                    const gifId = crypto.randomUUID();
                    try {
                        await dbHelper.addGif(gifId, gifFile);
                        const newCard = {
                            time: baseTime,
                            original,
                            back: gifId,
                            language: bulkLanguage.toLowerCase(),
                            shown: false,
                            answered: false,
                            sectionId: sectionId,
                            bulkOrder: i
                        };
                        flashcards.push(newCard);
                        addedCount++;
                    } catch (error) {
                        errors.push(`GIF kaydedilemedi: ${gifFile.name} - ${error}`);
                    }
                }

                if (errors.length > 0) {
                    showModal(`<h3>Toplu Ekleme Hatalarƒ±</h3><ul style="text-align:left; max-height: 200px; overflow-y:auto; padding-left:20px;">${errors.map(e => `<li>${e}</li>`).join('')}</ul>`, null);
                }
                
                if (addedCount > 0) {
                    saveData();
                    showToast(`${addedCount} adet kart ba≈üarƒ±yla eklendi.`, 'success');
                    bulkTextInput.value = '';
                    bulkGifFilenamesList.innerHTML = '';
                    bulkGifFiles = [];
                    bulkGifInput.value = '';
                }
            };


            // --- Ayarlar Penceresi Fonksiyonlarƒ± ---
            const openSettingsModal = () => {
                settingsModalOverlay.classList.add('show');
                resetControlsTimeout();
            };
            const closeSettingsModal = () => {
                settingsModalOverlay.classList.remove('show');
            };

            // --- Event Listeners ---
            uploadZoneContent.addEventListener('click', () => videoUpload.click());
            videoUpload.addEventListener('change', (e) => handleFileSelect(e.target.files[0])); 
            uploadZoneContent.addEventListener('dragover', (e) => { e.preventDefault(); uploadZoneContent.classList.add('dragover'); });
            uploadZoneContent.addEventListener('dragleave', () => uploadZoneContent.classList.remove('dragover'));
            uploadZoneContent.addEventListener('drop', (e) => { e.preventDefault(); uploadZoneContent.classList.remove('dragover'); handleFileSelect(e.dataTransfer.files[0]); });
            loadYoutubeBtn.addEventListener('click', loadYouTubeVideo);
            youtubeUrlInput.addEventListener('keyup', (e) => { if (e.key === 'Enter') loadYouTubeVideo(); });
            video.addEventListener('play', updatePlayIcon); video.addEventListener('pause', updatePlayIcon);
            video.addEventListener('timeupdate', updateProgress); video.addEventListener('progress', updateProgress);
            video.addEventListener('loadedmetadata', updateProgress); video.addEventListener('volumechange', updateVolumeIcon);
            video.addEventListener('ended', () => showToast('Video bitti!', 'info'));
            videoContainer.addEventListener('click', (e) => { if (e.target.closest('.controls-container') || e.target.closest('#flashcard-display')) return; togglePlay(); });
            playPauseBtn.addEventListener('click', togglePlay);
            progressContainer.addEventListener('click', setProgress);
            volumeBtn.addEventListener('click', toggleMute);
            volumeSlider.addEventListener('input', (e) => { const newVolume = parseFloat(e.target.value); if (playerMode === 'local') { video.muted = false; video.volume = newVolume; } else if (playerMode === 'youtube' && ytPlayer) { ytPlayer.unMute(); ytPlayer.setVolume(newVolume * 100); } });
            fullscreenBtn.addEventListener('click', toggleFullscreen);
            theaterBtn.addEventListener('click', toggleTheaterMode);
            
            // === JS G√úNCELLEMESƒ∞ BA≈ûLANGICI: Mouse event'lerini iframe'e de ekle ===
            youtubePlayerDiv.addEventListener('mousemove', resetControlsTimeout);
            videoContainer.addEventListener('mousemove', resetControlsTimeout);
            // === JS G√úNCELLEMESƒ∞ SONU ===
            
            videoContainer.addEventListener('mouseleave', () => { clearTimeout(controlsTimeout); hideControls(); });
            document.addEventListener('fullscreenchange', () => { 
                const isFullscreen = !!document.fullscreenElement; 
                fullscreenBtn.querySelector('i').className = `fa fa-${isFullscreen ? 'compress' : 'expand'}`; 
                // Tam ekran durumuna g√∂re .fullscreen sƒ±nƒ±fƒ±nƒ± ekle/kaldƒ±r
                if (isFullscreen) appContainer.classList.add('fullscreen'); 
                else appContainer.classList.remove('fullscreen'); 
            });
            
            // ===== POPUP MEN√ú AYARLARI (KALƒ∞TE MEN√úS√ú EKLENDƒ∞) =====
            const setupPopup = (btn, menu) => { btn.addEventListener('click', (e) => { e.stopPropagation(); menu.classList.toggle('show'); }); };
            setupPopup(subtitleBtn, subtitleMenu); 
            setupPopup(speedBtn, speedMenu);
            setupPopup(qualityBtn, qualityMenu); // Kalite men√ºs√º i√ßin eklendi
            
            settingsBtn.addEventListener('click', e => { e.stopPropagation(); openSettingsModal(); });
            closeSettingsBtn.addEventListener('click', closeSettingsModal);
            // Yeni kapatma butonu i√ßin event listener
            closeSettingsScoreboardBtn.addEventListener('click', closeSettingsModal); 
            settingsModalOverlay.addEventListener('click', (e) => {
                if (e.target === settingsModalOverlay) {
                    closeSettingsModal();
                }
            });

            // ===== DI≈ûARI TIKLAMA (KALƒ∞TE MEN√úS√ú EKLENDƒ∞) =====
            document.addEventListener('click', e => { 
                if (subtitleMenu.classList.contains('show') && !subtitleMenu.contains(e.target) && !subtitleBtn.contains(e.target)) subtitleMenu.classList.remove('show');
                if (speedMenu.classList.contains('show') && !speedMenu.contains(e.target) && !speedBtn.contains(e.target)) speedMenu.classList.remove('show');
                if (qualityMenu.classList.contains('show') && !qualityMenu.contains(e.target) && !qualityBtn.contains(e.target)) qualityMenu.classList.remove('show'); // Kalite men√ºs√º i√ßin eklendi
            });
            
            speedMenu.querySelectorAll('button').forEach(btn => { btn.addEventListener('click', () => { setPlaybackSpeed(parseFloat(btn.dataset.speed)); speedMenu.classList.remove('show'); }); });
            tabButtons.forEach(button => button.addEventListener('click', () => { const targetTab = button.dataset.tab; tabButtons.forEach(btn => btn.classList.remove('active')); tabContents.forEach(content => content.classList.remove('active')); button.classList.add('active'); document.getElementById(targetTab).classList.add('active'); }));
            
            resetScoreBtn.addEventListener('click', () => { if (!currentVideoKey) return showToast('√ñnce bir video y√ºkleyin.', 'info'); showModal('Bu videonun skorunu sƒ±fƒ±rlamak istediƒüinize emin misiniz?', () => { scoreCorrect = 0; scoreIncorrect = 0; flashcards.forEach(c => c.answered = false); updateScoreDisplay(); saveData(); hideModal(); showToast('Skor ve kart cevaplarƒ± sƒ±fƒ±rlandƒ±.', 'success'); }); });
            resetAllSettingsBtn.addEventListener('click', () => showModal('UYARI: Bu i≈ülem B√úT√úN flashcard GIFlerini, skorlarƒ± ve ayarlarƒ± kalƒ±cƒ± olarak silecektir. Emin misiniz?', async () => { localStorage.clear(); await indexedDB.deleteDatabase(dbHelper.DB_NAME); hideModal(); showToast('T√ºm veriler sƒ±fƒ±rlandƒ±. Sayfa yenileniyor.', 'success'); setTimeout(() => location.reload(), 1500); }));
            document.addEventListener('keydown', e => {
                if (settingsModalOverlay.classList.contains('show') && e.key !== 'Escape') {
                    return;
                }

                const activeEl = document.activeElement.tagName.toLowerCase(); if (activeEl === 'input' || activeEl === 'textarea') return;
                
                if (e.key === 'Escape') {
                    if (settingsModalOverlay.classList.contains('show')) {
                        closeSettingsModal();
                    } else if (isFlashcardShowing) {
                        isFlashcardShowing = false;
                        flashcardDisplay.classList.remove('show');
                        playVideo();
                    } else if (pendingFlashcardStep) {
                        pendingFlashcardStep = null;
                        showToast('Adƒ±m atlandƒ±.', 'info');
                    }
                    return;
                }

                switch(e.key.toLowerCase()) {
                    case 'k': case ' ': e.preventDefault(); togglePlay(); break;
                    case 'f': toggleFullscreen(); break; case 'm': toggleMute(); break;
                    case 'c': if(playerMode === 'youtube' && subtitleBtn.style.display !== 'none') subtitleBtn.click(); break;
                    case 'arrowright': skip(5); break; case 'arrowleft': skip(-5); break;
                }
            });
            modalCancelBtn.addEventListener('click', hideModal);
            modalConfirmBtn.addEventListener('click', () => { if (currentModalCallback) currentModalCallback(); });
            
            // ===== G√ñR√úN√úM AYARI EVENT LISTENERLARI KALDIRILDI =====

            flashcardStepDelayInput.addEventListener('input', (e) => { flashcardStepDelay = parseInt(e.target.value, 10) || 0; saveData(); });
            flashcardAutoIntervalInput.addEventListener('input', (e) => { autoFlashcardDelay = parseInt(e.target.value, 10) || 5; saveData(); });
            toggleAutoFlashcardBtn.addEventListener('click', () => { isAutoFlashcardActive ? stopAutoFlashcard() : startAutoFlashcard(); });
            
            flashcardDisplay.addEventListener('click', (e) => {
                if (isFlashcardShowing && !e.target.closest('#voice-quiz-container')) {
                    startIntermediatePlayback();
                }
            });
            
            bulkGifSelectBtn.addEventListener('click', () => bulkGifInput.click());
            bulkGifInput.addEventListener('change', handleBulkGifSelection);
            bulkAddAllBtn.addEventListener('click', handleAddAllCards);
            
            exportDataBtn.addEventListener('click', exportData);
            importDataBtn.addEventListener('click', () => importFileInput.click());
            importFileInput.addEventListener('change', (e) => { const file = e.target.files[0]; if (!file) return; const reader = new FileReader(); reader.onload = (event) => { try { handleImportedData(JSON.parse(event.target.result)); } catch (err) { showToast('JSON dosyasƒ± okunamadƒ± veya bozuk.', 'error'); } }; reader.readAsText(file); e.target.value = ''; });

            // --- Init ---
            // Sizin uygulamanƒ±zƒ±n DOMContentLoaded'i lisans doƒürulandƒ±ktan sonra √ßaƒürƒ±lacak
            const startApp = async () => {
                try {
                    await dbHelper.init();
                    initializeSettings(); 
                    updateScoreDisplay();
                    openSettingsModal();
                    
                    document.addEventListener('visibilitychange', handleVisibilityChange);

                    document.body.addEventListener('click', async () => {
                        await Tone.start();
                        if (!synth) synth = new Tone.Synth().toDestination();
                        if (!errorSynth) { errorSynth = new Tone.Synth({ oscillator: { type: 'sawtooth' }, volume: -12 }).toDestination(); }
                    }, { once: true });
                } catch (error) { showModal(`Uygulama ba≈ülatƒ±lamadƒ±. Tarayƒ±cƒ±nƒ±z IndexedDB'yi desteklemiyor olabilir.<br><br>Hata: ${error}`, null); }
            };

            // Bu fonksiyonu global scope'a ta≈üƒ±yoruz ki lisans script'i √ßaƒüƒ±rabilsin
            window.startProtectedApp = startApp;

        </script>
        <!-- YouTube API'si, lisans script'inden sonra y√ºklenecek -->
        
    </div> <!-- #protected-content sonu -->


    <!-- 3. Lƒ∞SANS KONTROL SCRIPT'ƒ∞ -->
    <script>
        const form = document.getElementById('license-form');
        const overlay = document.getElementById('license-overlay');
        const content = document.getElementById('protected-content');
        const errorMessage = document.getElementById('error-message');
        const licenseInput = document.getElementById('license-key');

        // Form g√∂nderildiƒüinde
        form.addEventListener('submit', async (e) => {
            e.preventDefault(); // Sayfanƒ±n yeniden y√ºklenmesini engelle
            const key = licenseInput.value.trim();
            errorMessage.style.display = 'none'; // √ñnceki hatalarƒ± gizle

            if (!key) return;

            try {
                // API'ye POST isteƒüi g√∂nder
                const response = await fetch('/api/check-license', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ licenseKey: key }),
                });

                const data = await response.json();

                if (response.ok && data.success) {
                    // Ba≈üarƒ±lƒ±: Giri≈ü ekranƒ±nƒ± gizle, i√ßeriƒüi g√∂ster
                    sessionStorage.setItem('verifiedLicense', 'true'); // Sayfa yenilemeleri i√ßin
                    showContent();
                } else {
                    // Ba≈üarƒ±sƒ±z: API'den gelen hata mesajƒ±nƒ± g√∂ster
                    errorMessage.textContent = data.message || 'Bilinmeyen bir hata olu≈ütu.';
                    errorMessage.style.display = 'block';
                }
            } catch (err) {
                errorMessage.textContent = 'Sunucuya baƒülanƒ±lamadƒ±. ƒ∞nternetinizi kontrol edin.';
                errorMessage.style.display = 'block';
            }
        });

        function showContent() {
            overlay.style.display = 'none';
            content.style.display = 'block';

            // Sizin uygulamanƒ±zƒ±n YouTube API script'ini y√ºkle
            const ytScript = document.createElement('script');
            ytScript.src = 'https://www.youtube.com/iframe_api';
            document.body.appendChild(ytScript);

            // Sizin uygulamanƒ±zƒ±n ba≈ülatma fonksiyonunu √ßaƒüƒ±r
            // (DOMContentLoaded yerine bunu kullanƒ±yoruz)
            if (window.startProtectedApp) {
                window.startProtectedApp();
            }
        }

        // Sayfa y√ºklendiƒüinde, daha √∂nce doƒürulama yapƒ±lmƒ±≈ü mƒ± diye kontrol et
        document.addEventListener('DOMContentLoaded', () => {
            if (sessionStorage.getItem('verifiedLicense') === 'true') {
                showContent();
            }
        });
    </script>
    
    <!-- 
        NOT: Sizin dosyanƒ±zdaki <script src="https://www.youtube.com/iframe_api"></script> 
        etiketi buraya ta≈üƒ±ndƒ± ve lisans doƒürulamasƒ±ndan SONRA y√ºklenecek ≈üekilde ayarlandƒ±.
    -->

</body>
</html>
